\documentclass{report}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage[noadjust]{cite}
\usepackage{enumerate}
\usepackage{mathrsfs}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{wrapfig}
\usepackage{caption}
\usepackage[position=b]{subcaption}
\usepackage{hyperref}


\newtheorem{theorem}{Theorem}[section]
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{cor}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{question}[theorem]{Question}
\newtheorem{example}[theorem]{Example}
\newtheorem{defprop}[theorem]{Definition-Proposition}

\DeclareMathOperator{\Coh}{Coh}
\DeclareMathOperator{\Diag}{Diag}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\cExt}{\mathscr{E} \! \textit{xt}}
\DeclareMathOperator{\Gr}{Gr}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Ho}{H}
\newcommand{\cHom}{\mathcal{H} \textit{om}}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Ob}{Ob}
\DeclareMathOperator{\Sch}{{\bf Sch}}
\DeclareMathOperator{\Sh}{Sh}
\DeclareMathOperator{\Sing}{Sing}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Vect}{{\bf Vec}}
\DeclareMathOperator{\Zar}{Zar}

\renewcommand{\AA}{\mathcal{A}}
\newcommand{\BB}{\mathcal{B}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\CL}{\mathcal{C}}
\newcommand{\DD}{\mathcal{D}}
\newcommand{\EE}{\mathscr{E}}
\newcommand{\FF}{\mathscr{F}}
\newcommand{\GG}{\mathscr{G}}
\newcommand{\cH}{\mathscr{H}}
\newcommand{\HH}{\mathbb{H}}
\newcommand{\II}{\mathscr{I}}
\newcommand{\JJ}{\mathscr{J}}
\newcommand{\bL}{\textbf{L}}
\newcommand{\LL}{\mathcal{L}}
\newcommand{\MM}{\mathscr{M}}
\newcommand{\OO}{\mathcal{O}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\qis}{\simeq_{qis}}
\newcommand{\qisf}{\simeq_{qis,filt}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\bR}{\textbf{R}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\otimesL}{\otimes^{\bf L}}

\newcommand*\xbar[1]{%
  \hbox{%
    \vbox{%
      \hrule height 0.5pt % The actual bar
      \kern0.5ex%         % Distance between bar and symbol
      \hbox{%
        \kern-0.1em%      % Shortening on the left side
        \ensuremath{#1}%
        \kern-0.1em%      % Shortening on the right side
      }%
    }%
  }%
} 

\newcommand{\tu}{\underline{2}}
\DeclareMathOperator{\red}{red}
\newcommand{\DB}{\underline{\Omega}}
\newcommand{\db}{\underline{\omega}^\bullet}
\DeclareMathOperator{\tot}{tot}

\begin{document}
	
\tableofcontents

\chapter{Diagrams of Schemes and Their Sheaves}
\section{Diagram Categories}
In general, a diagram in a given category $A$ will be a collection of objects in morphisms in that category, the idea is we want to deal with that whole collection simultaneously: for a cubical hyperresolution, the diagram will contain the resolution of singularities \textit{and} information about how the resolution map transforms the space.

In general, one can work with arbitrary functors from some small category to $A$, but this can be messier than we need.
The following definition makes some reasonable restriction:
\begin{definition}
	A \textit{diagram shape category} is a finite, thin (any two objects have at most one morphism between them) category without loops.
\end{definition}

It is clear why requiring finiteness makes things easier, the primary reason for requiring thinness is so that we can think of slice categories and over categories as fully faithful subcategories which makes some constructions simpler.
Finally, loops in a thin category are somewhat silly (each map in the loop must be an isomorphism), so categories with loops contain no further information than the category with the loops collapsed.

\begin{definition}
	Let $I$ be a diagram shape category and $A$ be any category.
	A \textit{diagram} in $A$ of shape $I$ (or an $I$-diagram) is a functor
	\[
		X_\bullet : I^{op} \rightarrow A.
	\]
	For each $\alpha$ and $\varphi$ an object and morphism from $I$ respectively, we'll write $X_\alpha$ and $X_\varphi$.
	
	A morphism between an $I$-diagram $X_\bullet$ and a $J$-diagram $Y_\bullet$ is given by a shape functor $\Gamma : I^{op} \rightarrow J^{op}$ and a natural transformation $\eta : X_\bullet \rightarrow Y_\bullet \circ \Gamma$.
	
	In simpler terms, this is a collection of morphisms such that the total diagram with all the arrows from the morphism and both diagrams drawn is commutative.
	Usually we'll denote a morphism as $f_\bullet : X_\bullet \rightarrow Y_\bullet$ with $\Gamma$ implicit and for each $\alpha \in I$, $f_\alpha : X_\alpha \rightarrow Y_{\Gamma(\alpha)}$. 
	
	Call a morphism \textit{shape-preserving} if $\Gamma$ is the identity, and \textit{shape-embedding} if it is fully faithful.
	
	The category of diagrams in $A$ will be denoted $\Diag A$, and the category of $I$-diagrams with shape-preserving morphisms in $A$ will be denoted $\Diag_I A$.
	
	There is a diagonal functor for each $I$, $\Delta : A \rightarrow \Diag_I$, where we'll denote $\Delta(X)$ by $X \times I$ (to be consistent with \cite{Guillen1988}), and $(X \times I)(\alpha) = X$ for all $\alpha$, with arrows the identity.
\end{definition}

The next definition introduces all the shapes we'll want to consider.

\begin{definition}
	Let $\underline{1}$ be the category $\{0\}$, and $\tu$ be the category $\{0 \rightarrow 1\}$.
	For $n \geq -1$, let $\Box_n^+$ be the product of $n+1$ copies of $\tu$.
	The elements here are tuples $\alpha = (\alpha_0, \dots, \alpha_n)$, with $\alpha_i \in \{0, 1\}$, and we can define $|\alpha| = \sum \alpha_i$.
	Let $\Box_n$ be the full subcategory without the initial object $(0, \dots, 0)$.
	See figure \ref{fig:boxn}.
\end{definition}

\begin{figure}
	\centering
	\begin{subfigure}[t]{.2\textwidth}
		\centering
		\begin{tikzcd}[row sep=8, column sep=8]
			\circ
		\end{tikzcd}
	\end{subfigure}%
	\begin{subfigure}[t]{.25\textwidth}
		\centering
		\begin{tikzcd}[row sep=8, column sep=8]
			\bullet & & \arrow[dashed]{ll} \circ
		\end{tikzcd}
	\end{subfigure}%
	\begin{subfigure}[t]{.25\textwidth}
		\centering
		\begin{tikzcd}[row sep=8, column sep=8]
			\bullet & & \bullet \arrow{ll} \\ \\
			\bullet \arrow{uu} & & \circ \arrow[dashed]{ll} \arrow[dashed]{uu}
		\end{tikzcd}
	\end{subfigure}%
	\begin{subfigure}[t]{.3\textwidth}
		\centering
		\begin{tikzcd}[row sep=8, column sep=8]
			& \bullet \arrow[leftarrow]{dd}& & \arrow{ll} \bullet  \\
			\bullet \arrow{ur}& & \arrow[crossing over]{ll} \bullet \arrow{ur} \\
			& \bullet & & \arrow{ll} \bullet \arrow{uu}  \\
			\bullet \arrow{ur} \arrow{uu} & & \arrow[dashed]{ll} \circ \arrow[dashed]{ur} \arrow[dashed,crossing over]{uu}\\
		\end{tikzcd}
	\end{subfigure}
	\caption{For $n \in \{-1, 0, 1, 2\}$, $\Box_n^+$ is the diagram with dashed arrows and an initial object, $\Box_n$ is the diagram without}
	\label{fig:boxn}
\end{figure}

\section{Sheaves on Diagrams}
With a definition of diagrams of schemes, we can now consider sheaves over diagrams, which are compatible collections of sheaves and morphisms over the schemes in the diagram.

\begin{definition}[10.84 of \cite{Kollar2013}]
	Let $X_\bullet$ be an $I$-scheme.
	A sheaf $\FF_\bullet$ on $X_\bullet$ is a collection of sheaves $\FF_\alpha$ on $X_\alpha$ with, for each $f : X_\alpha \rightarrow X_\beta$ in the diagram, morphisms $\FF_\beta \rightarrow f_* \FF_\alpha$, or equivalently $f^* \FF_\beta \rightarrow \FF_\alpha$.
	This is an abelian category, so we can also take the derived category of such sheaves.
\end{definition}

Given a map of diagrams, there are several associated functors of sheaves, analogous to those on literal schemes.
The easiest to construct is the pullback

\begin{definition}
	Let $X_\bullet$ be an $I$-scheme and $Y_\bullet$ be a $J$-scheme, $f_\bullet : X_\bullet \rightarrow Y_\bullet$ be a morphism of diagrams of schemes over the functor $\Phi : I^{op} \rightarrow J^{op}$.
	Then if $\GG_\bullet$ is a sheaf over $Y_\bullet$, define the pullback $f^*_\bullet \GG_\bullet$ a sheaf on $X_\bullet$ as
	\[
	(f^*_\bullet \GG_\bullet)_\alpha = f_\alpha^* \GG_{\Phi(\alpha)}.
	\]
	This functor is right-exact and has a left-derived functor on the derived categories
	\[
	(\bL f^*_\bullet G_\bullet)_\alpha = \bL f_\alpha^* G_{\Phi(\alpha)}.
	\]
\end{definition}

On the other hand, the pushforward is more mysterious, the problem being for each scheme in the target diagram, there are possibly many schemes mapping to it.
However, if this is the case then they form a diagram of sheaves over that target scheme, and we can define the pushforward as the limit of this diagram.

\begin{definition}
	\label{def:pushforward}
	Let $X_\bullet$ be an $I$-scheme and $Y_\bullet$ a $J$-scheme, $f_\bullet : X_\bullet \rightarrow Y_\bullet$ a morphism of diagrams of schemes over the functor $\Phi : I^{op} \rightarrow J^{op}$.
	Then if $\FF_\bullet$ is a sheaf over $X_\bullet$, define the pushforward $f_{\bullet*} \FF_\bullet$ a sheaf on $Y_\bullet$ as
	\[
	(f_{\bullet*} \FF_\bullet)_\alpha = \varprojlim_{(\beta, \phi)} Y_{\phi *} f_{\beta *} \FF_\beta,
	\]
	where $(\beta, \phi)$ ranges over $\beta \in I$ and $\phi : \Phi(\beta) \rightarrow \alpha$ a morphism in $J$.
	This functor is left-exact and has a right-derived functor on the derived categories
	\[
	(\bR f_{\bullet*} F_\bullet)_\alpha = \bR \varprojlim_{(\beta, \phi)} \bR Y_{\phi *} \bR f_{\beta *} F_\beta.
	\]
\end{definition}

\begin{prop}[I 5.5 of \cite{Guillen1988}]
	With these definitions and using this notation, $f_{\bullet *}$ is the right adjoint of $f_\bullet^*$ and $\bR f_{\bullet *}$ is the right adjoint of $\bL f_\bullet^*$.
\end{prop}

The main case of interest is a hyperresolution of a literal scheme, so it is worth considering in the case where $J = \underline{1}$, and even more particular where $I = \Box_n$.
After this first restriction, the functor $\bR f_{\bullet *}$ can be written as
\[
\bR f_{\bullet*} F_\bullet = \bR \varprojlim_\beta \bR f_{\beta *} F_\beta
\]

Restricting to $I = \Box_n$ is very powerful, as we will see in section \ref{sec:cubicaldescent}.

The following gives a notion of global sections for sheaves on diagrams:

\begin{definition}
	If $X_\bullet$ is a diagram of schemes, $\FF_\bullet$ a sheaf on $X_\bullet$, then define the functor
	\[
	\Gamma(X_\bullet, \FF_\bullet) = \varprojlim \Gamma(X_\alpha, \FF_\alpha).
	\]
	Similarly, if $F_\bullet \in D(X_\bullet)$, define
	\[
	\bR \Gamma(F_\bullet) = \bR \varprojlim \bR \Gamma(F_\alpha).
	\]
	Note that if $f_\bullet : X_\bullet \rightarrow \Spec k$ is a morphism to a field, $\Gamma = f_{\bullet *}$.
\end{definition}

Given $\FF_\bullet$ and $\GG_\bullet$, sheaves on $X_\bullet$, we can define $\Hom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$ as the morphisms in the category of sheaves, and this has many of the properties as before, however defining a sheaf $\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$ is more subtle as the most obvious choice does not have the natural maps required.
\begin{definition}
	Let $X_\bullet$ be a diagram of schemes, $\FF_\bullet$ and $\GG_\bullet$ two sheaves over $X_\bullet$.
	Define $\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$ as follows: for each $\alpha \in I$, and $U \subseteq X_\alpha$ open, let
	\[
	(\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet))_\alpha(U) = \Hom_{X_\bullet/U} ( i_U^* \FF_\bullet , i_U^* \GG_\bullet).
	\]
	This gives a sheaf on each $X_\alpha$.
	For $X_\phi : X_\alpha \rightarrow X_\beta$, $U \subseteq X_\beta$, there is a map $X_\bullet / \phi^{-1}(U) \rightarrow X_\bullet / U$ such that the $i$ maps commute, and putting this together gives maps $(\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet))_\beta(U) \rightarrow (\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet))_\alpha(X_\phi^{-1}(U))$ as needed.
\end{definition}

\begin{prop}
	Let $X_\bullet$ be a diagram of schemes, $\FF_\bullet$ and $\GG_\bullet$ two sheaves over $X_\bullet$.
	Then
	\[
	\Gamma(X_\bullet, \cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)) = \Hom_{X_\bullet}(\FF_\bullet, \GG_\bullet),
	\]
	and similarly if $F_\bullet, G_\bullet \in D^+(X_\bullet)$
	\[
	\bR \Gamma (\bR \cHom_{X_\bullet}(F_\bullet, G_\bullet)) = \bR \Hom_{X_\bullet}(F_\bullet, G_\bullet).
	\]
\end{prop}
\begin{proof}
	Note that $ \Hom_{X_\bullet / X_\alpha} ( i_{X_\alpha}^* \FF_\bullet , i_{X_\alpha}^* \GG_\bullet)$ consists of compatible morphisms of sheaves $\FF_\beta \rightarrow\nobreak \GG_\beta$ for each $\beta$ under $\alpha$, but then it is clear the inverse limit of these groups will be the collection of compatible morphisms $\FF_\beta \rightarrow \GG_\beta$ for all $\beta$, which is precisely $\Hom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$.
	
	The derived category version is simply by the composition of derived functors.
\end{proof}

The above proposition can be generalized for arbitrary $f_\bullet$, where in the last $\Gamma$ is viewed as the pushforward to a field.
The natural map obtained by this characterization is used in the sheaf version of duality.

\begin{prop}
	\label{thm:chomnatmap}
	Let $f_\bullet : X_\bullet \rightarrow Y_\bullet$ be a morphism of diagrams of schemes, and $\FF_\bullet$, $\GG_\bullet$ two $X_\bullet$ sheaves.
	Then there is a natural isomorphism, for each $U \subseteq Y_\alpha$
	\[
	f_{\bullet *}  \cHom_{X_\bullet} (\FF_\bullet, \GG_\bullet) (U) \xrightarrow{\sim} \Hom_{f_\bullet^{-1}(U)} ( i_{f_\bullet^{-1}(U)}^* \FF_\bullet, i_{f_\bullet^{-1}(U)}^* \GG_\bullet).
	\]
	
	Furthermore, there is a natural map
	\[
	f_{\bullet *} \cHom_{X_\bullet} (\FF_\bullet , \GG_\bullet) \rightarrow \cHom_{Y_\bullet} (f_{\bullet *} \FF_\bullet, f_{\bullet *} \GG_\bullet),
	\]
	and its derived version
	\[
	\bR f_{\bullet *} \bR \cHom_{X_\bullet} (F_\bullet , G_\bullet) \rightarrow \bR \cHom_{Y_\bullet} (\bR f_{\bullet *} F_\bullet, \bR f_{\bullet *} G_\bullet).
	\]
\end{prop}
\begin{proof}
	Working through the definitions,
	\[
	f_{\bullet *}  \cHom_{X_\bullet} (\FF_\bullet, \GG_\bullet) (U) = \varprojlim_{(\beta, \phi)} \Hom_{X_\bullet / f_\beta^{-1}(Y_\phi^{-1}(U)} (i_{f_\beta^{-1}(Y_\phi^{-1}(U)}^* \FF_\bullet, i_{f_\beta^{-1}(Y_\phi^{-1}(U)}^* \GG_\bullet).
	\]
	The elements on the left are tuples of compatible morphisms of sheaves $(\psi_{(\beta, \phi)})$, where $(\beta, \phi)$ ranges over $I \times_J \alpha/J$.
	$f_\bullet^{-1}(U)$ is a $I \times_J \alpha/J$ scheme, and working through the definitions, $(p_{f_\bullet^{-1}(U)}^* \FF_\bullet)_{(\beta, \phi)} = \FF_\beta |_{f^{-1}_\beta(Y_\phi^{-1}(U))}$, then $\psi_{(\beta, \phi)}$ gives a morphism from this to $(p_{f_\bullet^{-1}(U)}^* \GG_\bullet)_{(\beta, \phi)}$ for each $(\beta, \phi)$, and these maps are compatible.
	
	The inverse is the restriction of the morphism $i_{f_\bullet^{-1}(U)}^* \FF_\bullet \rightarrow i_{f_\bullet^{-1}(U)}^* \GG_\bullet$ to each of the components of the limit.
	
	To define the natural map, we can define compatible maps of the $U$ sections, and by the first part and the definition, these are maps
	\[
	\Hom_{f_\bullet^{-1}(U)} ( i_{f_\bullet^{-1}(U)}^* \FF_\bullet, i_{f_\bullet^{-1}(U)}^* \GG_\bullet) \rightarrow \Hom_{Y_\bullet / U} (i_U^* f_{\bullet *} \FF_\bullet, i_U^* f_{\bullet *} \GG_\bullet).
	\] 
	On each of the components, $i_U^*$ and $i_{f_\bullet^{-1}(U)}^*$ are just the restrictions, which $f_{\bullet *}$ is compatible with, so we can rewrite the right side as
	\[
	Hom_{Y_\bullet / U} (f_{\bullet *} i_{f_\bullet^{-1}(U)}^*\FF_\bullet,  f_{\bullet *} i_{f_\bullet^{-1}(U)}^*\GG_\bullet).
	\]
	Then it is clear the natural map is just the application of the functor $f_{\bullet *}$.
	
	The derived version is then tediously obtained by the sheaf version.
\end{proof}


\begin{prop}
	Let $X_\bullet$ be a diagram of schemes, $i_\bullet : U_\bullet \hookrightarrow X_\bullet$ a flat shape-embedding.
	Then $i_\bullet^*$ is an exact functor.
\end{prop}
\begin{proof}
	Let the shape functor of $i_\bullet$ be the inclusion of $J \hookrightarrow I$.
	Treat $i_\bullet$ as a composition, first an flat, shape-preserving map $U_\bullet \rightarrow X_\bullet|_J$ and the inclusion $X_\bullet|_J \rightarrow X_\bullet$.
	By \cite{Lipman2009}, II 6, the restriction functor to any subdiagram is exact (indeed, it has both a left and a right adjoint), and the pullback by a shape-preserving map splits over the components, in each component it is exact.
\end{proof}

It's tempting to think of complexes in the derived category of sheaves on a diagram as a sort of diagram of complexes in the derived categories of sheaves on the component schemes: an object $F_\alpha \in D(X_\alpha)$ and compatible morphisms $\bR X_{\phi_{\beta \alpha} *} F_\beta \rightarrow F_\alpha$.
This is a subtle issue: the complex category $C(\Sh(X_\bullet))$ is indeed this sort of construction, but the chain homotopies over the entire diagram are not the same as the chain homotopies over component combined, they must be compatible as well.
Here is a simple example of this phenomenon:
\begin{example}
	\label{ex:ddiagvsdiagd}
	Consider the diagram of schemes $X_\bullet = (\Spec k \rightarrow \Spec k)$ over the category $\tu$, and the following elements, of the complex category, $F_\bullet$:
	\[
		\begin{tikzcd}[column sep = small, row sep = small]
			\cdots \ar[r] & 0 \ar[r] \ar[d] & 0 \ar[r] \ar[d] & k \ar{r} \ar{d} & k \ar[r] \ar[d] & 0 \ar[r] \ar[d] & \cdots \\
			\cdots \ar[r] & 0 \ar[r] & 0 \ar[r] & k \ar[r] & 0 \ar[r] & 0 \ar[r] & \cdots,
		\end{tikzcd}
	\]
	and $G_\bullet$:
	\[
		\begin{tikzcd}[column sep = small, row sep = small]
			\cdots \ar[r] & 0 \ar[r] \ar[d] & 0 \ar[r] \ar[d] & k \ar[r] \ar[d] & 0 \ar[r] \ar[d] & 0 \ar[r] \ar[d] & \cdots \\
			\cdots \ar[r] & 0 \ar[r] & k \ar[r] & k \ar[r] & 0 \ar[r] & 0 \ar[r] & \cdots.
		\end{tikzcd}
	\]
	The chain maps between $F_\bullet$ and $G_\bullet$ are exactly what we think, chain maps between the two top rows and chain maps between the two bottom that are compatible, and thus $\Hom_{C(X_\bullet)}(F_\bullet, G_\bullet) = k$.
	Next, to compute the $\Hom$ in the derived category, since everything is injective here, we need only mod out by chain homotopy.
	When we ignore the compatibilities, and just consider each of $F_\bullet$ and $G_\bullet$ as two elements of $D(\Spec k)$ and a morphism between them, then we can replace the top row of $F_\bullet$ and the bottom row of $G_\bullet$ with 0 as these rows are quasi-isomorphic to 0, thus the $\Hom$ considered this way would itself be zero.
	However, the only nontrivial maps of the homotopy must fit into diagrams like
	\[
		\begin{tikzcd}
			k \arrow{r}{h} \ar[d] & k \ar[d] \\
			0 \ar[r] & k,
		\end{tikzcd}
	\]
	and therefore must be zero, so in fact $\Hom_{D(X_\bullet)}(F_\bullet, G_\bullet) = k$.
	
	Another thing to note about this is that $F_\bullet$ is not quasi-isomorphic to the complex 
	\[
	\begin{tikzcd}[column sep = small, row sep = small]
	\cdots \ar[r] &  0 \ar[r] \ar[d] & 0 \ar{r} \ar{d} & 0 \ar[r] \ar[d] & \cdots \\
	\cdots \ar[r] & 0 \ar[r] & k \ar[r] & 0 \ar[r] & \cdots,
	\end{tikzcd}
	\]
	as any morphism to or from this complex runs into the same issue: some subdiagram commuting meaning the map must be zero.
\end{example}
	
\section{Cubical Descent}
\label{sec:cubicaldescent}

As previously mentioned, we are particularly interested in the case of a $\Box_n$-diagram.
This has particularly nice properties in that the $\bR \varprojlim$ functor which is relatively mysterious in general becomes very concrete and even computable, it is given by the so-called simple functor, which appears in \cite{Guillen1988} I 6 and is developed further in \cite{Guillen2002} (an English reference is given by \cite{Pascual2009}).

For notational convenience, we'll consider $\Box_n = \{(\alpha_0, \dots \alpha_n) : \alpha_i \in \{0, 1\}\})$ as a subset of $\ZZ^n$.
Let $e_i$ be the $i$th basis vector of $\ZZ^n$, and let the morphism from $\alpha$ to $\alpha + e_i$ (which exists if and only if $\alpha_i = 0$ be denoted by $\phi_{(\alpha, i)}$.

\begin{definition}[\cite{Guillen1988} I 6]
	Let $F_\bullet : \Box_n \rightarrow C(A)$ be a diagram (over $\Box_n^{op}$) in the category of complexes in an abelian category $A$, where the differential of $F_\alpha$ is $d_\alpha$.
	Define the {\it simple complex} of $s(F_\bullet)$ to be the object in $C(A)$ with
	\[
	s(F_\bullet)^p = \bigoplus_\alpha F_\alpha^{p+1-|\alpha|}
	\] 
	and such that the differential on each $F_\alpha^{p+1-|\alpha|}$ is
	\[
	d = (\bigoplus_{\{i : \alpha_i = 0\}} (-1)^{\sum_{j < i} \alpha_j} F_{\phi_{(\alpha, i)}}) \oplus (-1)^{|\alpha|} d_\alpha.
	\]
\end{definition}

In more tangible terms, complex is obtained by combining all the complexes, staggering them to the right by the value of $|\alpha|$.
To illustrate, suppose $\Phi$ was the $\Box_1$-diagram
\[
\begin{tikzcd}
C^\bullet & \arrow{l} A^\bullet \\
B^\bullet \arrow{u}.
\end{tikzcd}
\]
Then to obtain the simple complex, we arrange the complexes, written out, as
\[
\begin{tikzcd}
\cdots \arrow{r}{-} &  A^0 \arrow{r}{-} \arrow{dr}{+} & A^1 \arrow{r}{-} \arrow{dr}{+} & A^2 \arrow{r}{-} \arrow{dr}{+} & \cdots \\
& \cdots \arrow{r}{+} & C^0 \arrow{r}{+} & C^1 \arrow{r}{+} & C^2 \arrow{r}{+} & \cdots \\
\cdots \arrow{r}{-} & B^0 \arrow{r}{-} \arrow{ur}{-} & B^1 \arrow{r}{-} \arrow{ur}{-} & B^2 \arrow{r}{-} \arrow{ur}{-} & \cdots
\end{tikzcd}
\]
and then take the direct sum of each column, with the signs above indicating the sign in the differential.

This can also be interpreted as taking a succession of mapping cones: treat $F_\bullet$ as a $(\Box_n^+)^{op}$-diagram with a 0 at the initial object, then since by definition $\Box_n^+ = \prod \tu$, $s$ on $\tu$ is the mapping cone, and by either direct computation or \cite{Guillen2002} $s$ factors over products.

\begin{prop}[\cite{Guillen1988} I 6.3, \cite{Guillen2002} 1.3.1]
	Let $A$ be an abelian category, then the simple complex is a functor $s:\Diag_{\Box_n} C(A) \rightarrow C(A)$ which takes quasi-isomorphisms to quasi-isomorphisms.
	
	Then this functor descends to the derived categories $D(\Diag_{\Box_n} A)$ and $\Diag_{\Box_n} D(A)$ and is the same when considering an object of the first as an object of the latter (so that the issues arising in example \ref{ex:ddiagvsdiagd} vanish when this functor is applied).
\end{prop}
\begin{prop}
	\label{thm:simple}
	Let $X_\bullet$ be a $\Box_n$-scheme with a map $f_\bullet : X_\bullet \rightarrow X$ to a scheme, and let $F_\bullet$ be an element of the bounded below derived category of sheaves on $\Box_n$
	Then $\bR f_{\bullet *} F_\bullet$ is naturally quasi-isomorphic to the simple complex formed by the $\Box_n$ diagram of $\bR f_{\alpha *} F_\alpha$ for each $\alpha \in \Box_n$.
\end{prop}
\begin{proof}
	This is I 6.6 of \cite{Guillen1988} in the special case of $I = \underline{1}$, and $K_\bullet$ the functor sending 0 to $\Box_n$.
\end{proof}

This works just as well for functors $\Box_n \rightarrow C(A)$ (i.e. objects of $\Diag_{\Box_n^{op}} C(A)$).
To avoid confusion, we notate this differently:
\begin{definition}
	Let $F_\bullet \in \Diag_{\Box_n} C(A)$, define the complex $s^*(F_\bullet)$ via
	\[
		s^*(F_\bullet)^p = \oplus_\alpha F_\alpha^{p-1+|\alpha|}
	\]
	with differential on each $F_\alpha^{p-1+|\alpha|}$
	\[
		d = \bigoplus_{(i : \alpha_i = 0)} (-1)^{\sum_{j < i} \alpha_j} F_{\phi(\alpha,i)} \oplus (-1)^{|\alpha|} d_\alpha.
	\]
	
	Proposition \ref{thm:simple} holds for $s^*$ as well.
\end{definition}

The functors $s$ and $s^*$ have a sort of duality theorem:

\begin{theorem}
	\label{thm:simpleduality}
	Let $A$ be an abelian category, $F_\bullet \in D(\Diag_{\Box_n^{op}} A)$ and $G \in D(A)$, then $\bR \Hom(F_\bullet, G \times \Box_n^{op})$ is a $\Box_n$-diagram, $\bR \Hom(G \times \Box_n, F_\bullet)$ is a $\Box_n^{op}$-diagram and
	\begin{align*}
		\bR \Hom(s(F_\bullet), G) &= s^* (\bR \Hom(F_\bullet, G \times \Box_n^{op})) \\
		\bR \Hom(G, s(F_\bullet)) &= s (\bR \Hom(G \times \Box_n^{op}, F_\bullet))
	\end{align*}
	
	If $F \in D(A)$, $G_\bullet \in D(\Diag_{\Box_n} A)$, then the analogous equalities hold:
	
	\begin{align*}
		\bR \Hom(F, s^* (G_\bullet)) &= s^* (\bR \Hom(F \times \Box_n, G_\bullet)) \\
		\bR \Hom(s^*(G_\bullet), F) &= s(\bR \Hom(G_\bullet, F \times \Box_n))
	\end{align*}
	
	Furthermore, this continues to hold if $A$ is a category of sheaves and we use sheaf $\cHom$.
\end{theorem}
\begin{proof}
	These are all similar proofs, both in technique and tediousness, so we check the first only.
	
	Choose representatives of $F_\bullet$ and $G$ in $K(Diag_{\Box_n^{op}} A)$ and $K(A)$ respectively, with $G$ K-injective.
	Then $\bR \Hom(F, s^* (G_\bullet)$ is represented by the complex with degree $p$ given by
	\begin{align*}
		\bR \Hom(F, s^* (G_\bullet))^p &= \bigoplus_{i-j = p} \Hom(s(F_\bullet)^j, G^i) \\
		&= \bigoplus_{i-j = p} \Hom(\bigoplus_\alpha F_\alpha^{j + 1 - |\alpha|}, G^i) \\
		&= \bigoplus_\alpha \bigoplus_{i-j = p} \Hom(F_\alpha^{j + 1 - |\alpha|}, G^i) \\
		&= \bigoplus_\alpha \bigoplus_{i-k = p - 1 + |\alpha|} \Hom(F_\alpha^k, G^i) \\
		&= \bigoplus_\alpha \bR \Hom(F_\alpha, G)^{p-1+|\alpha|} \\
		&= s^* (\bR \Hom(F_\bullet, G \times \Box_n^{op}))^p.
	\end{align*}
	Furthermore, the differentials of the two complexes also agree after enough identifications.
\end{proof}

\section{Cubical Hyperresolutions}
\begin{prop}
	Suppose $\pi_\bullet : Y_\bullet \rightarrow X_\bullet$ is a cubical hyperresolution of the $I$-scheme $X_\bullet$, and $\xbar{X}_\bullet \rightarrow X_\bullet$ is a shape-embedding morphism of diagrams, an isomorphism on each component of $\xbar{X}_\bullet$.
	Then $Y_\bullet \times_{X_\bullet} \xbar{X}_\bullet \rightarrow \xbar{X}_\bullet$ is a cubical hyperresolution of $\xbar{X}_\bullet$.
\end{prop}
\begin{proof}
	Take the sequence of 2-resolutions which gives $\pi_\bullet$ as cubical hyperresolutions, then the fibered product of each of these remains a 2-resolution as closed immersions, birational maps, and fibered products are all preserved.
	Finally, the reduction of this sequence gives $Y_\bullet \times_{X_\bullet} \xbar{X}_\bullet$.
\end{proof}

\begin{prop}[\cite{Guillen1988} I 6.7]
	\label{prp:cubicalcohospecseq}
	Let $X_\bullet$ be a $\Box_n$-scheme, and $F_\bullet \in D(X_\bullet)$.
	Then there is a spectral sequence computing the cohomology of $F_\bullet$:
	\[
		E_1^{pq} = \bigoplus_{|\alpha| = p + 1} \HH^q(X_\alpha, F_\alpha) \Rightarrow \HH^{p+q}(X_\bullet, F_\bullet).
	\]
	For a morphism $\pi_\bullet : X_\bullet \rightarrow X$ to a scheme $X$, this generalizes to a spectral sequence
	\[
		E_1^{pq} = \bigoplus_{|\alpha| = p + 1} \bR^q \pi_{\alpha *}F_\alpha \Rightarrow \bR^{p+q} \pi_{\bullet *} F_\bullet.
	\]
\end{prop}
	
\section{Grothendieck Topology}
\begin{defprop}
	For any diagram of schemes $X_\bullet$, define the Zariski site $\Zar(X_\bullet)$ to be the category of shape-embedding open immersions $U_\bullet \rightarrow X_\bullet$, with morphisms compatible shape-embedding open immersions $U_\bullet \rightarrow V_\bullet$.
	
	For each $U_\bullet$, a set of maps $\{U_{\bullet i} \rightarrow U_\bullet\}$ in the category is a covering if each component of $U_\bullet$, $U_\alpha$ is covered by the set of components $\{U_{\alpha i}\}$.
	These form a Grothendieck topology, and a morphism of the diagrams gives an associated morphism of the Zariski sites, and the category of sheaves over $X_\bullet$ is equivalent to the category of sheaves on $\Zar(X_\bullet)$, and each morphism of diagrams has an associated morphism of sites.
\end{defprop}
\begin{proof}
	An isomorphism is certainly a covering, as are refinements.
	Finally, a base change of a shape-preserving open immersion retains these properties and component-wise it is the base change of a covering in the usual topology, so this defines a topology.
	
	Define a functor $\Phi : \Sh(X_\bullet) \rightarrow \Sh(\Zar(X_\bullet))$ by $\Phi(\FF_\bullet)(U_\bullet) = \varprojlim  \FF_{\alpha}(U_\alpha)$, a limit ranging over the shape of $U_\bullet$.
	This functor is an equivalence, with $\Phi^{-1}(\GG)_\alpha = (U \mapsto \GG(U \hookrightarrow X_\bullet))$.
	
	For each $f_\bullet : X_\bullet \rightarrow Y_\bullet$ we can associate morphism of sites which takes $U_\bullet \hookrightarrow Y_\bullet$ to $U_\bullet \times_{Y_\bullet} X_\bullet \hookrightarrow X_\bullet$.
\end{proof}

\begin{defprop}[Tag 0408 from \cite{stacks}]
	A sheaf $\LL_\bullet$ on a diagram is called invertible if for each $U \in \Zar(X_\bullet)$, there is a covering $\{U_i \rightarrow U\}$ and isomorphisms $\OO_{X_\bullet/U_i} \xrightarrow{\sim} \LL_\bullet$.
	An invertible sheaf is equivariant (by a similar argument to II 7.3 from \cite{Lipman2009}), and if $\LL_\bullet^{-1} = \cHom(\LL_\bullet, \OO_{X_\bullet})$, then the natural map $\LL_\bullet \otimes \LL_\bullet^{-1} \rightarrow \OO_{X_\bullet}$ is an isomorphism.
	
	Equivalently, an invertible sheaf is an equivariant sheaf which is invertible on every component.
\end{defprop}

Note that this differs from the convention of ``$\FF_\bullet$ has property $P$ if each $\FF_\alpha$ does," in this case we need equivariance in order to take maps $X_\phi^* \LL_\beta \rightarrow \LL_\alpha$ and give a map from $X_\phi^* \LL_\beta^{-1}$ to $\LL_\alpha$.

\section{Quasi-coherentness}
	
\begin{lemma}
	\label{lem:affinecover}
	Let $I$ be a thin, finite category without loops and with an initial object.
	Then if $X$ is a quasi-compact $I$-scheme, there is a finite affine covering of $X$ in the Zariski site.
\end{lemma}

\begin{proof}
	First we note that the objects in $I$ can be partially-ordered such that each object only maps to the objects of larger order, that is, $\Ob I$ has a bijection with $\{0, \dots, N\}$ such that if there is a morphism $i \rightarrow j$, then $i \leq j$.
	The initial object must be 0 in this construction.
	
	Thus we can construct $X$ inductively as follows: let $X^0 = X_0$, and let $X^1$ be the full subdiagram of $X$ with only $X_0$ and $X_1$, etc., so that $X^n$ is obtained from $X^{n-1}$ by taking the diagram containing $X^{n-1}$, $X_n$, and all the maps $f_{n\alpha}:X_n \rightarrow X_\alpha$ out of $X_n$ in the diagram $X$, by construction these all map to objects in $X^{n-1}$.
	
	Construct $V_i^n$ as follows: for $X^0$ choose an open affine cover of $X_0$, and for $X_n$, for each $V_i^{n-1}$ choose an open affine cover $U_{ij}$ of $\cap_\alpha f_{n\alpha}^{-1}(V_{i\alpha})$ (here we take an empty intersection to be the entire space).
	Let $V_{ij}^n$ be the diagram $U_{ij} \xrightarrow{\{f_{n\alpha}\}_\alpha} V_i$.
	
	We wish to prove that for each $n$, this construction forms a cover as desired for $X^n$.
	This would follow by the construction and the following:
	
	Claim: For each $n$, $\cap_\alpha f_{n\alpha}^{-1}(V_{i\alpha})$ covers $X_n$.
	
	We prove this by induction.
	For $X_0$, the intersection the entire space, so this is true.
	In general, suppose $p \in X_n$.
	Let $\alpha_1, \dots, \alpha_m$ be the objects in $I$ which $n$ maps to, in their order.
	We must show that there is an element of $V_i^{n-1}$ which has $f_{\alpha_j}(p)$ in each $V_{i \alpha_j}^{n-1}$.
	
	There is a $V_{i_1}^{\alpha_1}$ containing $f_{\alpha_1}(p)$, by construction.
	Inducting on the $\alpha_i$'s, assume now that there is a $V_{i_{k-1}}^{\alpha_{k-1}}$ containing each of the $\{f_{\alpha_1}(p), \dots, f_{\alpha_{k-1}}(p)\}$.
	Then by the hypotheses, if $g_\beta$'s are the maps out of $X_{\alpha_k}$, $\cap_\beta g_{\beta}^{-1}(V_{i_{k-1}\beta})$ is a cover of $X_{\alpha_k}$, thus by construction there is a $V_{i_{k-1}j}^{\alpha_k}$ including $\{f_{\alpha_1}(p), \dots, f_{\alpha_{k}}(p)\}$.
\end{proof}

\begin{definition}
	Let $X_\bullet$ be a diagram of schemes, $\FF_\bullet$ and $\GG_\bullet$ two sheaves over $X_\bullet$.
	Define $\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$ as the sheaf-hom on the Zariski site, or equivalently as follows: for each $\alpha \in I$, and $U \subseteq X_\alpha$ open, let
	\[
		(\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet))_\alpha(U) = \Hom_{X_\bullet/U} ( i_U^* \FF_\bullet , i_U^* \GG_\bullet).
	\]
	This gives a sheaf on each $X_\alpha$.
	For $X_\phi : X_\alpha \rightarrow X_\beta$, $U \subseteq X_\beta$, there is a map $X_\bullet / X_\phi^{-1}(U) \rightarrow X_\bullet / U$ such that the $i$ maps commute, and putting this together gives maps $(\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet))_\beta(U) \rightarrow (\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet))_\alpha(X_\phi^{-1}(U))$ as needed.
\end{definition}

\begin{definition}
	A sheaf on $X_\bullet$ will be called (quasi-)coherent if each component is (quasi-)coherent.
	Note that this is not the same as being (quasi-)coherent as a sheaf on the Zariski site.
	As in II 7.3 of \cite{Lipman2009}, that is equivalent to this notion plus the following very strong condition:
	
	A sheaf $\FF_\bullet$ will be called equivariant if for each $X_\phi$ in the diagram, the map $X_\phi^* \FF_\alpha \rightarrow X_\beta$ is an isomorphism.
\end{definition}

\begin{defprop}
	Let $X_\bullet$ be an $I$-scheme, and $\alpha \in I$.
	Define the inclusion $j_\alpha : X_\alpha \hookrightarrow X_\bullet$ (note this is different than the previously defined $i_\alpha : X_\bullet / X_\alpha \hookrightarrow X_\bullet$).
	
	Then $(-)_\alpha = j_\alpha^*$, which has a right adjoint $j_{\alpha *}$ and a left adjoint $j_{\alpha !}$ as follows:
	For any $\OO_{X_\alpha}$-module $\FF_\alpha$, define $j_{\alpha !} \FF_{\alpha \bullet}$ a $\OO_{X_\bullet}$-module as
	\[
		j_{\alpha !} \FF_{\alpha \beta} = \begin{cases}
									X_{\phi_{\alpha \beta}}^* \FF_\alpha & \text{if }\beta \in \alpha/I \\
									0 & \text{if } \beta \not \in \alpha/I,
		\end{cases}
	\]
	with diagram maps the obvious isomorphisms. Furthermore $\cHom_{X_\bullet}(\FF_{\alpha \bullet}^\uparrow, -) = i_{X_\alpha *} \cHom(i_{X_\alpha}^* \FF_{\alpha \bullet}^\uparrow, i_{X_\alpha}^* -)$.
	
	Finally, for $F_\alpha \in D(X_\alpha)$, the derived version becomes $\bR \Hom_{X_\bullet}(\bL j_{\alpha !} F_{\alpha \bullet}, G_\bullet) = \bR \Hom_{X_\alpha}(F_\alpha, G_\alpha)$ and $\bR \cHom_{X_\bullet}(\bL j_{\alpha !}F_{\alpha \bullet}, G_\bullet) = \bR i_{X_\alpha *} \bR \cHom(i_{X_\alpha}^* \bL j_{\alpha !} F_{\alpha \bullet}, i_{X_\alpha}^* G_\bullet)$.
\end{defprop}
\begin{proof}
	For adjointness, we must show that $\Hom_{X_\alpha}(\FF_\alpha, \GG_\alpha) = \Hom_{X_\bullet}(j_{\alpha !} \FF_{\alpha \bullet}, \GG_\bullet)$.
	
	For each $\Phi \in \Hom_{X_\bullet}(j_{\alpha !}\FF_{\alpha \bullet}, \GG_\bullet)$, and $\beta \in \alpha/I$, the compatibility ensures that $\Phi_\beta$ is determined by $\Phi_\alpha$, and for $\eta \not \in \alpha/I$, this must be zero, which does not restrict the morphisms elsewhere since there are no maps from any such $\beta$ to any such $\eta$.
	
	For the second part, since the definition of $j_{\alpha !}$ commutes with restriction, the first part shows this is true restricted to $X_\alpha$.
	If $\beta \in \alpha / I$, then restricting everything to $X_\bullet / X_\beta$, this becomes the same situation for $X_{\phi_{\alpha \beta}}^* \FF_\alpha$.
	If $\beta \in I / \alpha$, then maps of sheaves on $X_\bullet / U$ for $U \subseteq X_\beta$ are determined by the maps on $X_\bullet / X_{\phi_{\beta \alpha}}^{-1}(U)$, and finally if $\beta$ is in neither subcategory then there are no maps in $X_\bullet / X_\beta$ as $j_{\alpha !}\FF_{\alpha \bullet}$ is zero everywhere.
	
	Finally, $\bL j_{\alpha !}$ is adjoint with the restriction functor (which is exact), and continues to commute with restriction to an open subset, so the derived versions hold.
\end{proof}

\begin{prop}
	\label{prp:homqcaffine}
	If $X_\bullet$ has affine arrows, then for any $\FF_\bullet$ coherent, $\GG_\bullet$ quasi-coherent, $\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$ is quasi-coherent.
	If in addition, $\GG_\bullet$ is coherent, $X_\bullet$ is noetherian, and the arrows are proper, then $\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$ is coherent.
\end{prop}
\begin{proof}
	Enough to show that for each $X_\alpha$, that the sheaf $(\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet))_\alpha$ is (quasi-)coherent, which can be done locally, and furthermore for each $U \subseteq X_\alpha$, the definition of $\cHom$ only depends on the diagram $X_\bullet / U$ so we can restrict to proving this for a terminal scheme in a diagram, and furthermore restrict that this scheme is affine.
	Because $X_\bullet$ has affine arrows, the entire diagram must be affine.
		
	Note that
	\[
		\Hom_{X_\bullet}(j_{\alpha !} \OO_{X_\alpha \bullet}, \GG_\bullet) = \GG_\alpha(X_\alpha).
	\]
	Furthermore,
	\[
		\cHom_{X_\bullet}(j_{\alpha !} \OO_{X_\alpha \bullet}, \GG_\bullet)_\beta = \begin{cases}
													\GG_\beta  & \text{if } \beta \in \alpha / I \\
													X_{\phi *} \GG_\alpha & \text{if } \phi : \beta \rightarrow \alpha \\
													0 & \text{otherwise}
													\end{cases},
	\]
	so this is quasi-coherent, and if the additional conditions are met, it is coherent.
	
	Each $\FF_\alpha$ is coherent on an affine scheme, so is the cokernel of a map of finite rank free modules, these give sequences, surjective on the $\alpha$ component of the diagram:
	\[
		j_{\alpha !}\OO_{X_\alpha \bullet}^{\oplus m_\alpha} \rightarrow j_{\alpha !}\OO_{X_\alpha \bullet}^{\oplus n_\alpha} \rightarrow \FF_\bullet.
	\]
	Combining these gives a $\FF$ as a cokernel:
	\[
		\bigoplus_\alpha j_{\alpha !}\OO_{X_\alpha \bullet}^{\oplus m_\alpha} \rightarrow \bigoplus_\alpha j_{\alpha !}\OO_{X_\alpha \bullet}^{ \oplus n_\alpha} \rightarrow \FF_\bullet \rightarrow 0.
	\]
	
	Applying $\cHom_{X_\bullet}(-,\GG_\bullet)$,
	\[
		0 \rightarrow \cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet) \rightarrow \cHom_{X_\bullet}(\bigoplus j_{\alpha !}\OO_{X_\alpha \bullet}, \GG_\bullet) \rightarrow \cHom_{X_\bullet}(\bigoplus j_{\alpha !}\OO_{X_\alpha \bullet}, \GG_\bullet),
	\]
	and since the direct sums are finite this can be rewritten as
	\[
		0 \rightarrow \cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet) \rightarrow \bigoplus \cHom_{X_\bullet}(j_{\alpha !}\OO_{X_\alpha \bullet}, \GG_\bullet) \rightarrow \bigoplus \cHom_{X_\bullet}(j_{\alpha !}\OO_{X_\alpha \bullet}, \GG_\bullet).
	\]
	Now since finite direct sums and kernels of (quasi-)coherent sheaves are (quasi-)coherent, we are done.
\end{proof}

\begin{theorem}
	If $X_\bullet$ is a concentrated $I$-scheme, then if $\FF_\bullet$ is coherent and $\GG_\bullet$ is quasi-coherent, $\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$ is quasi-coherent.
	If in addition $\GG_\bullet$ is coherent, and $X_\bullet$ is noetherian with proper arrows, then $\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)$ is coherent.
\end{theorem}
\begin{proof}
	As before, reduce to the case with $X_\bullet$ a diagram with an affine, terminal component $X_0$.
	Then apply lemma \ref{lem:affinecover} to $X_\bullet$ to have an affine diagram cover $\{V_{i\bullet}\}$.
	Each intersection $V_{i \bullet} \cap V_{j \bullet}$ is quasi-compact by quasi-separability, so we can reapply lemma \ref{lem:affinecover} to have affine diagram covers $\{V_{ijk\bullet}\}$.
	
	Have maps $\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)_0 \rightarrow \cHom_{V_{i\bullet}}(\FF_\bullet |_{V_{i\bullet}}, \GG_\bullet |_{V_{i \bullet}})_0$ given by restriction, and in fact if we are given $\phi_i \in \cHom_{V_{i\bullet}}(\FF_\bullet |_{V_{i\bullet}}, \GG_\bullet |_{V_{i \bullet}})_0$ for each $i$ such that $\phi_i |_{V_{ijk \bullet}} = \phi_j |_{V_{ijk \bullet}}$ for each $i, j, k$, then the morphisms glue uniquely to give $\psi \in \cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)_0$.
	
	This establishes the equalizer diagram
	\[
	\begin{tikzcd}[column sep=tiny]
		\cHom_{X_\bullet}(\FF_\bullet, \GG_\bullet)_0 \arrow{r} & \bigoplus_i \cHom_{V_{i\bullet}}(\FF_\bullet |_{V_{i\bullet}}, \GG_\bullet |_{V_{i \bullet}})_0 \arrow[yshift=.5ex]{r} \arrow[yshift=-.5ex]{r} & \bigoplus_{i,j,k} \cHom_{V_{ijk\bullet}}(\FF_\bullet |_{V_{ijk\bullet}}, \GG_\bullet |_{V_{ijk \bullet}})_0
	\end{tikzcd}
	\]
	by proposition \ref{prp:homqcaffine}, the right two terms are (quasi-)coherent, so as is the term on the left.
\end{proof}

\begin{theorem}
	Suppose $\GG_\bullet$ is an $\OO_{X_\bullet}$-module.
	Then the functors $\cHom_{X_\bullet}(\GG_\bullet, -)$ and $-\otimes\GG_\bullet$ are adjoint.
\end{theorem}
\begin{proof}
	Let $\FF_\bullet$ and $\cH_\bullet$ be arbitrary $\OO_{X_\bullet}$-modules, we will describe an isomorphism
	\[
		\Hom(\FF_\bullet, \cHom_{X_\bullet}(\GG_\bullet, \cH_\bullet)) \xrightarrow{\sim} \Hom(\FF_\bullet \otimes \GG_\bullet, \cH_\bullet)
	\]
	Note that if $\FF_\bullet \otimes^p \GG_\bullet$ is the presheaf tensor product, then there is a natural isomorphism $\Hom(\FF_\bullet \otimes \GG_\bullet, \cH_\bullet) \cong \Hom(\FF_\bullet \otimes^p \GG_\bullet, \cH_\bullet)$, so it is enough to show for the presheaf tensor product, and in this case $X_{\phi *} (\FF_\alpha \otimes^p \FF_\beta) \cong X_{\phi *} \FF_\alpha \otimes^p X_{\phi *} \GG_\alpha$, compatible with the arrows of $\FF_\bullet \otimes^p \GG_\bullet$.
	
	Given $\psi \in \Hom(\FF_\bullet, \cHom_{X_\bullet}(\GG_\bullet, \cH_\bullet))$, with restriction to each component $\alpha$ denoted $\psi_\alpha$, define a morphism $\FF_\alpha \otimes^p \GG_\alpha \rightarrow \cH_\alpha$ by $s \otimes t \mapsto \psi_\alpha(s)(t)$.
	It remains to check that these give compatible morphisms, namely to show the following diagram commutes:
	\[
		\begin{tikzcd}
			\FF_\alpha \otimes^p \GG_\alpha \arrow{rr}{s \otimes t \mapsto \psi_\alpha(s)(t)} \arrow{d}{\FF_\phi \otimes \GG_\phi} && \cH_\alpha \arrow{d}{\cH_\phi} \\
			X_{\phi *} \FF_\beta \otimes^p X_{\phi *}\GG_\beta \arrow{rr}{s \otimes t \mapsto \psi_\beta(s)(t)} && X_{\phi *} \cH_\beta.
		\end{tikzcd}
	\]
	Then we must show that for $s \otimes t$ in $\FF_\alpha \otimes^p \GG_\alpha$, $\cH_\phi (\psi_\alpha(s)(t)) = \psi_\beta(\FF_\phi s)(\GG_\phi t)$, or more abstractly that the following diagram commutes:
	\[
		\begin{tikzcd}
		\cHom_{X_\bullet / X_\alpha}(\GG_\bullet, \cH_\bullet)_\alpha \arrow{r} \arrow{dd} & \cHom_{X_\alpha}(\GG_\alpha, \cH_\alpha) \arrow{dr} \\
		& &  \cHom_{X_\alpha} (\GG_\alpha, X_{\phi *} \cH_\beta) \\
		X_{\phi *} \cHom_{X_\bullet / X_\beta}(\GG_\bullet, \cH_\bullet)_\beta \arrow{r} & X_{\phi *} \cHom_{X_\beta} (\GG_\beta, \cH_\beta) \arrow{r} & \cHom_{X_\alpha}(X_{\phi *} \GG_\beta, X_{\phi *} \cH_\beta) \arrow{u}.
		\end{tikzcd}
	\]
	Taking a morphism $\varphi \in \cHom_{X_\bullet / X_\alpha}(\GG_\bullet, \cH_\bullet)_\alpha$, the result of the map to the right is, for each $U \subseteq X_\alpha$, a module homomorphism $\GG_\alpha(U) \rightarrow \cH_\alpha(U)$.
	The result of the composition to the bottom right is, for each $U \subseteq X_\alpha$, a module homomorphism $\GG_\beta(X_\phi^{-1}(U)) \rightarrow \cH_\beta (X_\phi^{-1}(U))$.
	Then they map to the same morphism in $\cHom_{X_\alpha} (\GG_\alpha, X_{\phi *} \cH_\beta)$ by the compatibilities of the original map.
	
	Now given a $\psi \in \Hom(\FF_\bullet \otimes^p \GG_\bullet, \cH_\bullet)$, define for each $U \subseteq X_\alpha$, $s \in \FF_\alpha(U)$, and $\phi : \alpha \rightarrow \beta$, a map $\GG_\alpha(X_\phi^{-1}(U)) \rightarrow \cH_\alpha(X_\phi^{-1}(U))$ by $t \mapsto \psi_\alpha(\FF_\phi(s) \otimes t)$, and further a map on $V \subseteq X_\phi^{-1}(U)$ by restricting $\FF_\phi(s)$.
	This defines an element of $\cHom_{X_\bullet / X_\alpha}(\GG_\bullet, \cH_\bullet)$, as these morphisms are compatible by the compatibility of $\psi$ and $\FF_\phi$.
	
	By careful consideration the two operations described are inverses, so the functors are adjoint.
\end{proof}

\begin{theorem}
	The derived functor $\bR \cHom_{X_\bullet}(-,-)$ takes $D^-(X_\bullet)^{op} \times D^+(X_\bullet)$ to $D^+(X_\bullet)$.
	Furthermore, it takes $D^-_c(X_\bullet)^{op} \times D^+_{qc}(X_\bullet)$ to $D^+_{qc}(X_\bullet)$.
\end{theorem}
\begin{proof}
	For each $F_\bullet \in D^-(X_\bullet)$, $G_\bullet \in D^+(X_\bullet)$, $\bR \cHom_{X_\bullet}(F_\bullet, G_\bullet)$ is defined by replacing $G_\bullet$ with an injective resolution $I_\bullet$, and then taking the total complex of the double complex
	\[
	\begin{tikzcd}
				{}&	\vdots \arrow{d}	&	\vdots \arrow{d} & \\
		\cdots	\arrow{r}	&	\cHom_{X_\bullet}(F^i_\bullet, I^j_\bullet) \arrow{r} \arrow{d}	&	\cHom_{X_\bullet}(F^{i-i}_\bullet, I^j_\bullet) \arrow{d} \arrow{r}	& \cdots \\
		\cdots	\arrow{r}	&	\cHom_{X_\bullet}(F^i_\bullet, I^{j+1}_\bullet) \arrow{r} \arrow{d}	&	\cHom_{X_\bullet}(F^{i-i}_\bullet, I^{j+1}_\bullet) \arrow{d} \arrow{r}	& \cdots \\
				&	\vdots	&	\vdots &
	\end{tikzcd}
	\]
	
	As the diagonals move to the left, eventually each term must be zero by the bounds on the original complexes.
	Furthermore, if each term in $F_\bullet$ is coherent and each term in $G_\bullet$ is quasi-coherent, then $I_\bullet$ can be taken to be a quasi-coherent injective resolution and thus each term in the double complex is quasi-coherent.
\end{proof}

\begin{theorem}
	The derived functor $-\otimesL-$ takes $D(X_\bullet) \times D(X_\bullet)$ to $D(X_\bullet)$.
	Furthermore, it takes $D_{qc}(X_\bullet) \times D_{qc}(X_\bullet)$ to $D_{qc}(X_\bullet)$ and $D_{c}(X_\bullet) \times D_{c}(X_\bullet)$ to $D_{c}(X_\bullet)$.
\end{theorem}
\begin{proof}
	$(F_\bullet \otimesL G_\bullet)_\alpha = F_\alpha \otimesL G_\alpha$.
\end{proof}

\begin{theorem}
	Suppose $G_\bullet \in D(X_\bullet)$.
	Then the functors $\bR \cHom_{X_\bullet}(G_\bullet, -)$ and $-\otimesL G_\bullet$ are adjoint.
\end{theorem}
\begin{proof}
	This is an application tag 09T5 of \cite{stacks}.
\end{proof}

\begin{definition}
	A morphism $f_\bullet : X_\bullet \rightarrow Y_\bullet$ from a $\Box_n \times I$-scheme $X_\bullet$ to an $I$-scheme $Y_\bullet$ over the functor projecting to $I$ is called a \textit{cubical morphism}.
\end{definition}

\begin{theorem}
	\label{thm:pushforwardbounds}
	Let $f_\bullet : X_\bullet \rightarrow Y_\bullet$ be a concentrated, cubical morphism.
	Then $\bR f_{\bullet *} : D(X_\bullet) \rightarrow D(X_\bullet)$ maps $D_{qc}(X_\bullet)$ to $D_{qc}(X_\bullet)$, $D^-(X_\bullet)$ to $D^-(X_\bullet)$, and if $f_\bullet$ is a proper morphism of noetherian schemes, $D_c(X_\bullet)$ to $D_c(X_\bullet)$.
	Furthermore the right adjoint to $\bR f_{\bullet *}$ on $D_{qc}(X_\bullet)$, $f_\bullet^!$ maps $D_{qc}^+(X_\bullet)$ to $D_{qc}^+(X_\bullet)$.
\end{theorem}
\begin{proof}
	The derived limit on each component preserves (quasi-)coherence and is bounded above, so by the simple complex construction, the derived limit of the total pushforward on each component $Y_\alpha$ also has these properties.
	Then the adjoint is bounded below by Lemma 4.1.8 of \cite{Lipman2009}.
\end{proof}

\chapter{Grothendieck Duality on Diagrams}

\section{Abstract $f_\bullet^!$ for an Morphism of Diagrams}
For morphisms of projective schemes over $k$, $f : X \rightarrow Y$, Grothendieck duality can be stated as the existence of a right adjoint to $\bR f_*$, written $f^!$.
By the various properties of these maps, we then have an isomorphism for $F \in D_{coh}^+(X), G \in D_{coh}^+(Y)$
\[
\bR f_* \bR \cHom_X(F, f^! G) \cong \bR \cHom_Y(\bR f_* F, G)
\]
The theory of this adjoint is developed in detail in \cite{Hartshorne1966}.

We wish to develop a theory of Grothendieck duality for morphisms of diagrams of schemes $f_\bullet : X_\bullet \rightarrow Y_\bullet$.
Some progress on this is made in \cite{Lipman2009}, however this is restricted to the case where the shape of $X_\bullet$ and $Y_\bullet$ is the same.
The first step in this is proving the existence of an adjoint.
Instead of a direct proof as in \cite{Hartshorne1966}, we can use Neeman's proof of Grothendieck duality via Brown representability in \cite{Neeman1996}, though this does not help with construction.
Below is the critical existence theorem

\begin{theorem}[4.1 of \cite{Neeman1996}]
	\label{thm:neeman4.1}
	Let $\CL$ be a compactly generated triangulated category, $\DD$ any triangulated category, and let $F : \CL \rightarrow \DD$ be a triangulated functor which respects coproducts.
	Then $F$ has a right adjoint.
\end{theorem}

\begin{cor}
	Let $f_\bullet : X_\bullet \rightarrow Y_\bullet$ be a morphism of diagrams of projective schemes over a field.
	Then $\bR f_{\bullet *}$ has a right adjoint $f^!_\bullet$.
\end{cor}
\begin{proof}
	The category $D_{qc}^+(X_\bullet)$ is compactly generated by diagrams of perfect complexes (see 17.1 of \cite{Lipman2009}).
	As a derived functor of $f_{\bullet *}$, $\bR f_{\bullet *}$ is triangulated.
	For any morphism of schemes $\phi$, $\bR \phi_*$ respects coproducts.
	Finally, so does $\bR \varprojlim$, so $\bR f_{\bullet *}$ has a right adjoint by \ref{thm:neeman4.1}.
\end{proof}

\begin{definition}
	Let $p_\bullet : X_\bullet \rightarrow \Spec k$ be the structure map of a concentrated diagram of schemes.
	Define the canonical complex $\omega_{X_\bullet}^\bullet = p_\bullet^! k$
\end{definition}

This is analogous to the dualizing complex on schemes, however it is rarely dualizing (in the sense of $\bR \cHom(\omega_{X_\bullet}^\bullet, \omega_{X_\bullet}^\bullet) \qis \OO_{X_\bullet}$), so we will not call it that.

Our next goal is to compute this object.
The next construction will be important for this.
\begin{definition}
	Let $X_\bullet$ be an $I$-scheme and $\alpha \in I$. Define an object in the derived category of diagrams of sheaves on $X_\alpha$ over $I$ as $\hat{\omega}_\bullet^\alpha \in D(X_\bullet)$
	\[
		\hat{\omega}^\alpha_\beta =  \begin{cases}
											\bR X_{\phi_{\beta \alpha} *} \omega_{X_\beta}^\bullet & \text{if } \beta \in \alpha / I \\
											0 & \text{otherwise,}
									\end{cases}
	\]
	where the nonzero diagram maps are the pushforwards of the natural maps $\bR X_{\phi_{\gamma \beta} *} \omega_{X_\gamma}^\bullet \rightarrow \omega_{X_\beta}$.

	The direction of the maps here can be confusing: note that diagrams are contravariant functors.
	For any arrow $\phi_{\gamma \beta} : \beta \rightarrow \gamma$ in $I$, there is a morphism $X_{\phi_{\gamma \beta}} : X_\gamma \rightarrow X_\beta$ and a morphism $\hat{\omega}^\alpha_\gamma \rightarrow \hat{\omega}^\alpha_\beta$.
	This is in contrast with a sheaf $\FF_\bullet$ on the diagram of schemes with morphisms $\FF_\beta \rightarrow X_{\phi_{\gamma \beta} *} \FF_\gamma$.
\end{definition}

\begin{theorem}
	For any $X_\bullet$ a proper, noetherian $\Box_n$-scheme over a field $k$, and $\alpha \in \Box_n$, there is a natural isomorphism
	\[
		(\omega_{X_\bullet}^\bullet)_\alpha = s^*(\hat{\omega}^\alpha_\bullet)
	\]
\end{theorem}
\begin{proof}
	For any $F \in D(X_\alpha)$, we have 
	\begin{align*}
	\Hom(F, (\omega_{X_\bullet}^\bullet)_\alpha) &= \Hom(\bL j_{\alpha !} F_\bullet, \omega_{X_\bullet}^\bullet) \\
	&= \Hom(\bR \Gamma(j_{\alpha !} F_\bullet), k) \\
	&= h^0(\bR \Hom(s(\bR \Gamma (j_{\alpha !} F_\beta)),k)) \\
	&= h^0(s^* \bR \Hom(\bR \Gamma(j_{\alpha !} F_\beta), k)) \\
	\end{align*}
	using theorem \ref{thm:simpleduality}.
	
	For $\beta \in \alpha / I$, $j_{\alpha !} F_\beta = \bL X_{\phi_{\beta \alpha}}^* F$, so using Grothendieck duality
	\begin{align*}
		\bR \Hom(\bR \Gamma(j_{\alpha !} F_\beta),k)  &= \bR \Hom(\bL X_{\phi_{\beta \alpha}}^* F, \omega_{X_\alpha}^\bullet) \\
		&= \bR \Hom(F, \bR X_{\phi_{\beta \alpha} *} \omega_{X_\alpha}^\bullet) \\
		&= \bR \Hom(F, \hat{\omega}^\alpha_\beta)
	\end{align*}
	similarly, if $\beta \not \in \alpha / I$, both $\bR \Hom(\bR \Gamma(j_{\alpha !} F_\beta), k)$ and $\Hom(F, \hat{\omega}^\alpha_\beta)$ are zero.
	
	Thus, continuing from above,
	\begin{align*}
		h^0(s^* \bR \Hom(\bR \Gamma(j_{\alpha !} F_\beta), k)) &= h^0(s^* \bR \Hom(F \times \Box_n, \hat{\omega}^\alpha_\bullet)) \\
		&= \Hom(F, s^*(\hat{\omega}^\alpha_\bullet))
	\end{align*}
	again using \ref{thm:simpleduality}.
	
	Finally, we are done by the Yoneda lemma.
\end{proof}

\section{Projection Formula/Duality}

\begin{theorem}
	Let $f_\bullet : X_\bullet \rightarrow Y_\bullet$ be a proper morphism of noetherian diagrams of schemes.
	Suppose that for $F_\bullet \in D_{c}^-(X_\bullet)$, the projection formula natural transformation of functors $D_{qc}(Y_\bullet) \rightarrow D_{qc}(Y_\bullet)$
	\[
		- \otimesL \bR f_{\bullet *} F_\bullet \rightarrow \bR f_{\bullet *}(\bL f_\bullet^* - \otimesL F_\bullet)
	\]
	is an isomorphism.
	Then the Grothendieck duality natural transformation of functors $D_{qc}^+(Y_\bullet) \rightarrow D_{qc}^+(Y_\bullet)$
	\[
		\bR f_{\bullet *} \bR \cHom_{X_\bullet} (F_\bullet, f_\bullet^! -) \rightarrow \bR \cHom_{Y_\bullet} (\bR f_{\bullet *} F_\bullet, -)
	\]
	is an isomorphism.
\end{theorem}
\begin{proof}
	By theorem \ref{thm:pushforwardbounds}, $\bR f_{\bullet *}$ maps $D^-_{c}(X_\bullet)$ to $D_c^-(X_\bullet)$.
	Thus each of these is well-defined as functors to the indicated categories.
	
	Next we note that if $E_\bullet \in D_{qc}(X_\bullet)$, then for any $G_\bullet \in D_{qc}^+(X_\bullet)$, the two transformations are conjugate and fit into the diagram
	\[
	\begin{tikzcd}
		\Hom(\bR f_{\bullet *}(\bL f_\bullet^* E_\bullet \otimesL F_\bullet), G_\bullet) \arrow{d}[sloped, above]{\sim} \arrow{r} & \Hom(E_\bullet \otimesL \bR f_{\bullet *} F_\bullet, G_\bullet) \arrow{d}[sloped, above]{\sim} \\
		\Hom(E_\bullet, \bR f_{\bullet *} \bR \cHom_{X_\bullet} (F_\bullet, f_\bullet^! G_\bullet) \arrow{r} & \Hom(E_\bullet, \bR \cHom_{Y_\bullet} (\bR f_{\bullet *} F_\bullet, G_\bullet)).
	\end{tikzcd}
	\]
	By hypothesis, the top arrow is an isomorphism, so as is the bottom arrow.
	Then by Yoneda's lemma, the Grothendieck duality transformation is an isomorphism.
\end{proof}

\begin{theorem}
	\label{thm:flatbasechange}
	Let $u_\bullet : U_\bullet \rightarrow X_\bullet$ and $f_\bullet : Y_\bullet \rightarrow X_\bullet$ be morphisms of diagrams of schemes, and $V_\bullet = U_\bullet \times_{X_\bullet} Y_\bullet$, with projections $g_\bullet$ to $U_\bullet$ and $v_\bullet$ to $Y_\bullet$.
	Then the natural transformation of functors $D_{qc}(Y_\bullet) \rightarrow D_{qc}(U_\bullet)$
	\[
		\bL u_\bullet^* \bR f_{\bullet *} \rightarrow \bR g_{\bullet *} \bL v_\bullet^*,
	\]
	and if $u_\bullet$ is flat and $f_\bullet$ is cubical, this is an isomorphism.
\end{theorem}
\begin{proof}
	The natural map is the composition
	\begin{align*}
		\bL u_\bullet^* \bR f_{\bullet *} &\rightarrow \bR g_{\bullet *} \bL g_\bullet^* \bL u_\bullet^* \bR f_{\bullet *} \\
		&\rightarrow \bR g_{\bullet *} \bL v_\bullet^* \bL f_\bullet^* \bR f_{\bullet *} \\
		&\rightarrow \bR g_{\bullet *} \bL v_\bullet^*.
	\end{align*}
	
	Now suppose $F_\bullet \in D_{qc}(Y_\bullet)$ and $u_\bullet$ is a functor over $\Phi : I \rightarrow J$.
	Then for each $\alpha \in I$, by definition,
	\[
		(\bR g_{\bullet *} \bL v_\bullet^* F_\bullet)_\alpha = \bR \varprojlim_{\beta \in \Box_n} \bR g_{(\alpha, \beta) *} \bL v_{(\alpha, \beta)}^* F_\beta,
	\]
	then by usual flat base change for schemes, this becomes
	\[
		 \bR \varprojlim_{\beta \in \Box_n} \bL u_{\alpha}^*  \bR f_{\beta *} F_\beta.
	\]
	By definition,
	\[
		(\bL u_\bullet^* \bR f_{\bullet *} F_\bullet)_\alpha = \bL u_\alpha^* \bR \varprojlim_{\beta \in \Box_n} \bR f_{\beta *} F_\beta,
	\]
	so we have reduced to showing that for a flat morphism of schemes $u : U \rightarrow X$, a $\Box_n$-diagram of complexes $F_\bullet$ on $X$, $\bL u^* \bR \varprojlim F_\bullet = \bR \varprojlim \bL u^*$.
	
	By flatness, $\bL u^* = u^*$, and by using the simple complex construction $\bR \varprojlim F_\bullet$ becomes a complex with each degree the direct sum of $F_\alpha^p$s and differential maps the direct sum of maps $F_\alpha \rightarrow F_\beta$.
	Since $u^*$ commutes with all of these, $u^* \bR \varprojlim F_\bullet$ is in fact the simple complex of $u^* F_\bullet$.
\end{proof}

\begin{theorem}
	Let $f_\bullet : X_\bullet \rightarrow Y_\bullet$ be a cubical morphism.
	Then for each $F_\bullet \in D_{qc}(X_\bullet)$, the projection formula natural transformation of functors on $D_{qc}(X_\bullet)$
	\[
	- \otimesL \bR f_{\bullet *} F_\bullet \rightarrow \bR f_{\bullet *}(\bL f_\bullet^* - \otimesL F_\bullet)
	\]
	is an isomorphism.
\end{theorem}
\begin{proof}	
	It is enough to show this over each component of $Y_\bullet$, and $\bR f_{\bullet *}$ is computed independently on each component of $Y$ via the stratification of $f_\bullet$, so we can assume $Y$ is a scheme, and $f_\bullet : X_\bullet \rightarrow Y$
	
	Then this morphism is local in $Y$ using theorem \ref{thm:flatbasechange}, so we can reduce to the case where $Y$ is affine.
	Here, $\OO_Y$ is ample and generates the category $D_{qc}(Y)$, and since each functor is triangulated from $D_{qc}(Y)$ to $D_{qc}(Y)$, and preserves coproducts, it is in fact enough to show just for $\OO_Y$, where it is trivial.
\end{proof}

\begin{cor}
	\label{cor:cubicalgrothdual}
	If $f_\bullet : X_\bullet \rightarrow Y_\bullet$ is a cubical, projective morphism of noetherian diagrams of schemes, then for any $F_\bullet \in D_{c}^-(X_\bullet)$, $G_\bullet \in D_{qc}^+(X_\bullet)$, the Grothendieck duality map is an isomorphism:
	\[
		\bR f_{\bullet *} \bR \cHom(F_\bullet, f_\bullet^! G_\bullet) \xrightarrow{\sim} \bR \cHom(\bR f_{\bullet *} F_\bullet, G_\bullet).
	\]
	Furthermore,
	\[
		\bR f_{\bullet *} \bR \cHom(F_\bullet, \omega_{X_\bullet}^\bullet) \xrightarrow{\sim} \bR \cHom(\bR f_{\bullet *} F_\bullet, \omega_{Y_\bullet}^\bullet).
	\]
\end{cor}

\begin{example}
	Let $X$ be a scheme, and $Y_\bullet$ be the diagram $X \rightarrow X$ with the identity map (for convenience, labeled $X_1 \rightarrow X_2$).
	Then we have a morphism of diagrams $f_\bullet$ as follows:
	\[
	\begin{tikzcd}
		X \arrow{r}{\id} & X_1 \arrow{d}{\id} \\
		& X_2.
	\end{tikzcd}
	\]
	
	We will construct a counterexample to the projection formula and Grothendieck duality for this morphism of diagrams.
	Let $\FF_\bullet$ be the sheaf over $Y_\bullet$ which is 0 on $X_1$ and $\OO_{X_2}$ on $X_2$.
	Now consider the natural morphism
	\[
		\bR f_{\bullet *} (\bL f_\bullet^* \FF_\bullet) \rightarrow \FF_\bullet \otimes \bR f_{\bullet *} \OO_X
	\]
	
	Using the definition of the pushforward, $(\bR f_{\bullet *} \OO_X)_1 = \bR \varinjlim \OO_{X_1} = \OO_{X_1}$ and $(\bR f_{\bullet *} \OO_X)_2 = \bR \varinjlim \OO_{X_2} = \OO_{X_2}$, so the right side is $\FF_\bullet$.
	On the other hand, $\bL f_\bullet^* \FF_\bullet = \bL \id^* 0 = 0$ so the left side is 0 and this is not a natural isomorphism.
	
	Then we can do the same for the Grothendieck duality map
	\[
		\bR f_{\bullet *} \bR \cHom(\OO_X, f_\bullet^! \FF_\bullet) \rightarrow \bR \cHom(\bR f_{\bullet *} \OO_X , \FF_\bullet):
	\]
	by the previous computation this is morphism $\bR f_{\bullet *} f_\bullet^! \FF_\bullet \rightarrow \FF_\bullet$, and the right hand side gives the same sheaf when restricted to either $X_1$ or $X_2$, while $\FF_\bullet$ is not the same on each.
\end{example}

\begin{cor}
	Let $X$ be a reduced scheme, finite-type over $\CC$, and let $f_\bullet : X_\bullet \rightarrow X$ be a cubic hyperresolution.
	Then $X$ has Du Bois singularities if and only if the natural map
	\[
		\bR f_{\bullet *} \omega^\bullet_{X_\bullet} \xrightarrow{\sim} \omega^\bullet_X
	\]
	is a quasi-isomorphism.
\end{cor}
\begin{proof}
	Suppose $X$ has Du Bois singularities, so that the natural map
	\[
		\OO_X \xrightarrow{\sim} \bR f_{\bullet *} \OO_{X_\bullet}
	\]
	is a quasi-isomorphism.
	Then applying the functor $\bR \cHom(-,\omega_X^\bullet)$, and using corollary \ref{cor:cubicalgrothdual},
	\begin{align*}
		\omega_X^\bullet &\xleftarrow{\sim} \bR \cHom(\bR f_{\bullet *} \OO_{X_\bullet}, \omega_X^\bullet) \\
		&\xleftarrow{\sim} \bR f_{\bullet *} \bR \cHom(\OO_{X_\bullet}, \omega_{X_\bullet}^\bullet) \\
		&\xleftarrow{\sim} \bR f_{\bullet *} \omega_{X_\bullet}^\bullet
	\end{align*}
	
	Now assume this map is an isomorphism.
	Applying the same functor and using the fact that $\omega_X^\bullet$ is dualizing,
	\begin{align*}
		\bR \cHom(\omega_X^\bullet, \omega_X^\bullet) &\xrightarrow{\sim} \bR \cHom(\bR f_{\bullet *} \omega_{X_\bullet}^\bullet, \omega_X^\bullet) \\
		&\xrightarrow{\sim} \bR \cHom(\bR f_{\bullet *} \bR \cHom(\OO_{X_\bullet}, \omega_{X_\bullet}^\bullet), \omega_{X}^\bullet) \\
		&\xrightarrow{\sim} \bR \cHom(\bR \cHom(\bR f_{\bullet *} \OO_{X_\bullet}, \omega_X^\bullet), \omega_X^\bullet) \\
		\OO_X &\xrightarrow{\sim} \bR f_{\bullet *} \OO_{X_\bullet}
	\end{align*}
\end{proof}

\begin{cor}
	Suppose $\pi_\bullet : X_\bullet \rightarrow X$ is a cubical hyperresolution.
	Then $X$ has Du Bois singularities if and only if the unit of adjunction
	\[
		\id \rightarrow \bR \pi_{\bullet *} \bL \pi_\bullet^*
	\]
	is a natural isomorphism.
	Dually, $X$ has Du Bois singularities if and only if the counit of adjunction
	\[
		\bR \pi_{\bullet *} \pi_\bullet^! \rightarrow \id
	\]
	is a natural isomorphism.
\end{cor}
\begin{proof}
	By the projection formula, $\bR \pi_{\bullet *} \bL \pi_\bullet^* F \qis F \otimesL \bR \pi_{\bullet *} \OO_{X_\bullet}$ for each $F$.
	The morphism $F \rightarrow F \otimesL \bR \pi_{\bullet *} \OO_{X_\bullet}$ is an isomorphism for all $F$ if and only if $X$ is Du Bois.
	
	The second part is then conjugate to the first.
\end{proof}

\begin{prop}
	\label{prp:cohofdual}
	Let $\EE_\bullet$ be a locally free sheaf on $X_\bullet$, a proper noetherian diagram over a field $k$.
	Then $\Hom(\bR \Gamma(\EE_\bullet),k) = \bR \Gamma(\EE^\vee \otimes \omega_{X_\bullet}^\bullet)$, and taking homology,
	$\HH^i (X_\bullet, \EE_\bullet)^* = \HH^{-i}(X_\bullet, \EE_\bullet^\vee \otimes \omega_{X_\bullet}^\bullet)$.
\end{prop}
\begin{proof}
	Using Grothendieck duality, and since $\Hom(-,k)$ is exact,
	\begin{align*}
		\Hom(\bR \Gamma(\EE_\bullet),k) &= \bR \Hom(\EE_\bullet, \omega_{X_\bullet}^\bullet) \\
		&= \bR \Hom(\OO_{X_\bullet}, \EE_\bullet^\vee \otimes \omega_{X_\bullet}^\bullet) \\
		&= \bR \Gamma(\EE_\bullet^\vee \otimes \omega_{X_\bullet}^\bullet)
	\end{align*}
	
	For the last statement, take the $-i$ homology of both sides.
	Since $\Hom(-,k)$ is contravariant it reverses the complex and gives the dual of the $i$th homology.
\end{proof}

\begin{example}
	Let $X$ be two planes intersecting at a point.
	Then for any ample line bundle $\LL$, $H^{-1}(X,\db_X \otimes \LL)^* = k$.
	
	We can compute this by giving a hyperresolution $\pi_\bullet : X_\bullet \rightarrow X$:
	
	\[\begin{tikzcd}
		k \arrow{r} \arrow{d} & \PP^2 \arrow{d}{f} \\
		\PP^2 \arrow{r}{g} & X.
	\end{tikzcd}\]
	
	Now by the projection formula $\LL \otimes \db_X = \bR \pi_{\bullet *} (\pi_\bullet^* \LL \otimes \omega_{X_\bullet}^\bullet)$, so $\HH^{-1}(X, \LL \otimes \db_X)^* = \HH^{-1}(X_\bullet, \pi_\bullet^* \LL \otimes \omega_{X_\bullet}^\bullet)^*$.
	
	By proposition \ref{prp:cohofdual}, this is $H^1(X_\bullet, \pi_\bullet^* \LL^{-1})$, which can now compute directly.
	The component of this sheaf on the $\PP^2$s is the inverse of a big and nef line bundle, so the cohomology will vanish in degree less than 2 by Kawamata-Vieweg vanishing.
	The component over $k$ is the only possible line bundle, $k$ over itself.
	
	Now, we the spectral sequence of proposition \ref{prp:cubicalcohospecseq}, which we can compute in entirety:
	
	\[\begin{tikzcd}[row sep = tiny, column sep = tiny]
	H^2(\PP^2, f^* \LL^{-1} \oplus g^* \LL^{-1}) & 0 \\
	0 & 0 \\
	0 & k.
	\end{tikzcd}\]
	
	This is degenerate and thus $H^1(X_\bullet, \pi_\bullet^* \LL^{-1}) = k$.
\end{example}

This illustrates that any vanishing in this vein will necessitate we restrict to Cohen-Macaulay schemes.

\begin{example}
	Let $Y$ be a smooth projective variety and $X$ a projective cone over $Y$.
	If $\LL$ is an ample line bundle on $X$, then for $2 \leq i \leq \dim Y$, $\HH^{-i}(X, \LL \otimes \db_X)^* = H^i(Y, \OO_Y)$, in particular this is not zero if $Y$ is, say, a ruled surface over a curve of genus $g \geq 1$.
	
	To see this, let $\pi_\bullet : X_\bullet \rightarrow X$ be the cubical hyperresolution
	\[\begin{tikzcd}
		S \arrow{r} \arrow{d} & B \arrow{d} \\
		k \arrow{r} & X,
	\end{tikzcd}\]
	where $B$ is the resolution of $X$.
	As above, $\HH^{-i}(X, \LL \otimes \db_X)^* = \HH^i(X_\bullet, \pi_\bullet^* \LL^{-1})$.
	Let $\MM$ be the term of $\pi_\bullet^* \LL$ on $B$, $\MM$ is the pullback of an ample sheaf via a generically finite map, so it is big and nef.
	On $k$ it must be $k$ over itself, and thus by the diagram commuting, on $Y$ the pullback is $\OO_Y$.
	
	Now we can bring in the spectral sequence of proposition \ref{prp:cubicalcohospecseq}.
	Let $n = \dim Y$; because of Kawamata-Viehweg vanishing, $H^i(B, \MM^{-1}) = 0$ for $i < \dim B  = n + 1$, so the $E_1$ page appears as
	\[\begin{tikzcd}[row sep = tiny, column sep = tiny]
		H^{n+1}(B, \MM) \arrow{r} & 0 \\
		0 \arrow{r} & H^n(Y, \OO_Y) \\
		\vdots & \vdots \\
		0 \arrow{r} & H^1(Y, \OO_Y) \\
		k \arrow{r} & k,
	\end{tikzcd}\]
	and it is now clear that the $E_\infty$ page will be
	\[\begin{tikzcd}[row sep = tiny, column sep = tiny]
	H^{n+1}(B, \MM) & 0 \\
	0  & H^n(Y, \OO_Y) \\
	\vdots & \vdots \\
	0 & H^1(Y, \OO_Y) \\
	0 & 0,
	\end{tikzcd}\]
	and the result follows.
\end{example}

\begin{lemma}[proof of \cite{Kovacs2011a} 3.3]
	Let $X$ be a variety over $\CC$, $\LL$ an ample line bundle.
	Then for all $j \in \ZZ$, the natural map
	$\HH^j(X, \db_X \otimes \LL) \hookrightarrow \HH^j(X,\omega_X^\bullet \otimes \LL)$ is an injection.
\end{lemma}

\section{Relative Differentials}

\begin{definition}
	Let $f_\bullet : X_\bullet \rightarrow Y_\bullet$ be a morphism of diagrams of schemes over the functor $\Phi : I \rightarrow J$.
	Then define a sheaf $\Omega_{X_\bullet / Y_\bullet}$ on the diagram $X_\bullet$ as follows: for each $\alpha \in I$,
	\[
		(\Omega_{X_\bullet / Y_\bullet})_\alpha = \Omega_{X_\alpha / Y_{\Phi(\alpha)}}
	\]
	and for each $X_\alpha \rightarrow X_\beta$, the map $\phi_{\alpha \beta}^* (\Omega_{X_\bullet / Y_\bullet})_\beta \rightarrow (\Omega_{X_\bullet / Y_\bullet})_\alpha$ is given by
	\[
		\phi_{\alpha \beta}^* \Omega_{X_\beta / Y_{\Phi(\beta)}} \xrightarrow{\sim} p^* \Omega_{X_\beta \times_{Y_{\Phi(\beta)}} Y_{\Phi(\alpha)} / Y_{\Phi(\alpha)}} \rightarrow \Omega_{X_\alpha / Y_{\Phi(\alpha)}}
	\]
	
	This defines a sheaf over the diagram since for any $X_\alpha \rightarrow X_\beta \rightarrow X_\delta$, the diagram
	\[
		\begin{tikzcd}
			X_\alpha \arrow{rr} \arrow{dr} & & Y_{\Phi(\alpha)} \times_{Y_{\Phi(\delta)}} X_\delta \\
			& Y_{\Phi(\alpha)} \times_{Y_{\Phi(\beta)}} X_\beta \arrow{ur} & {}
		\end{tikzcd}
	\]
	commutes.
\end{definition}

\begin{theorem}
	\label{thm:locfreereldiffs}
	Let $f : X \rightarrow B$ be a smooth morphism from a smooth scheme $X$ to a smooth, 1-dimensional scheme $B$.
	Then for each $p$ there is a finite locally-free resolution of $\Omega_{X/B}^p$ given by
	\[
		\cdots \rightarrow f^* \omega_B^{\otimes 2} \otimes \Omega_X^{p-2} \rightarrow f^* \omega_B \otimes \Omega_X^{p-1} \rightarrow
			\Omega^p_X \rightarrow \Omega_{X/B}^p \rightarrow 0
	\]
\end{theorem}
\begin{proof}
	First note there is always a right exact sequence
	\[
		f^* \omega_B \otimes \Omega_X^{p-1} \rightarrow \Omega_X^p \otimes \Omega_{X/B}^p \rightarrow 0
	\]
	by tag 00DO of \cite{stacks}, and when $B$ is 1-dimensional, there is an exact sequence
	\[
		0 \rightarrow f^* \omega_B \otimes \Omega_{X/B}^{p-1} \rightarrow \Omega_X^p \rightarrow \Omega_{X/B}^p \rightarrow 0.
	\]
	The image of the left map in the first exact sequence is then  $f^* \omega_B \otimes \Omega_{X/B}^{p-1}$ and we can apply the first sequence for $p-1$ and tensored with $f^* \omega_B$ to extend the first sequence to 
	\[
	f^* \omega_B^{\otimes 2} \otimes \Omega_X^{p-2} \rightarrow f^* \omega_B \otimes \Omega_X^{p-1} \rightarrow
	\Omega^p_X \rightarrow \Omega_{X/B}^p \rightarrow 0
	\]
	while remaining exact.
	By continuing in this manner using these two exact sequences tensored with $f^* \omega_B$ an appropriate number of times (note this is flat), we get the exact sequence as desired.
\end{proof}

\begin{definition}
	Let $f : X \rightarrow B$ be a morphism from any scheme $X$ to a smooth scheme $B$ over a field of characteristic 0.
	For a cubical hyperresolution $\pi_\bullet : X_\bullet \rightarrow X$ and nonnegative integer $p$, we can define
	\[
		\DB_{X/B}^p = \bR \pi_{\bullet *} \Omega_{X_\bullet / B}^p.
	\]
	Note that a priori this is not independent of choice of hyperresolution.
\end{definition}

\begin{prop}
	Let $f : X \rightarrow B$ be a morphism from a noetherian scheme $X$ to a smooth, 1-dimensional scheme $B$ over a field of characteristic 0.
	Then for any cubical hyperresolution, there is a spectral sequence computing the homology of $\DB_{X/B}^p$:
	\[
		E_1^{ij} = f^* \omega_B^{\otimes (p - j)} \otimes h^i(\DB_X^j) \Rightarrow h^{i+j}(\DB_{X/B}^p).
	\]
	
	Thus the homology of $\DB_{X/B}^p$ is independent of choice of hyperresolution.
\end{prop}
\begin{proof}
	Let $f_\bullet = f \circ \pi_\bullet$.
	Applying remark 2.67 of \cite{Huybrechts2006}, we have the spectral sequence
	\[
		E_1^{ij} = \bR^i \pi_{\bullet *} (f_\bullet^* \omega_B^{\otimes(p-j)} \otimes \Omega_{X_\bullet}^j) \Rightarrow \bR^{i+j} \pi_{\bullet *} \Omega_{X/B}^p
	\]
	
	To finish this, apply some definitions and the projection formula:
	\begin{align*}
		\bR^i \pi_{\bullet *} (f_\bullet^* \omega_B^{\otimes(p-j)} \otimes \Omega_{X_\bullet}^j) &= h^i (\bR \pi_{\bullet *} (\pi_\bullet^* f^* \omega_B^{\otimes(p-j)} \otimes \Omega_{X_\bullet}^j)) \\
		&= h^i (f^* \omega_B^{\otimes(p-j)} \otimes \bR \pi_{\bullet *}\Omega_{X_\bullet}^j) \\
		&= f^* \omega_B^{\otimes (p - j)} \otimes h^i(\DB_X^j).
	\end{align*}
	
	The last claim is due to the independence of $\DB_X^j$.
\end{proof}

\bibliography{../library}{}
\bibliographystyle{plain}
\end{document}
